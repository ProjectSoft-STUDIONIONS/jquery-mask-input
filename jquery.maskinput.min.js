/*
  Mask Input plugin for jQuery
  Copyright (c) 2013 Josh Bush (shaungrady.com)
  Licensed under the MIT license (https://github.com/shaungrady/jquery-mask-input/blob/master/LICENSE)
  Version: 1.0
*/
(function(e,t,n,r){function s(e,t){if(t!==r){if(e.setSelectionRange){e.focus();e.setSelectionRange(t,t)}else if(e.createTextRange){var i=e.createTextRange();i.collapse(true);i.moveEnd("character",t);i.moveStart("character",t);i.select()}}else{var s=0;if(n.selection){e.focus();var o=n.selection.createRange();o.moveStart("character",-e.value.length);s=o.text.length}if(e.selectionStart!==r)s=e.selectionStart;return s}}function o(e){if(e.selectionStart!==r)return e.selectionEnd-e.selectionStart;if(n.selection)return n.selection.createRange().text.length}var i={9:/\d/,A:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/};e.fn.extend({maskInput:function(t){if(!this.length)return this;return this.filter("input").each(function(n,u){function p(t){var n="",r=c.slice();e.each(t.split(""),function(e,t){if(r.length&&r[0].test(t)){n+=t;r.shift()}});return n}function d(t){var n="",r=0;e.each(f.split(""),function(e,s){if(i[s])n+=t.charAt(r++)||"_";else n+=s});return n}function v(t){var n=e(this);if(!n.data("isUnmaskedValueValid")){n.val("");n.attr("value-unmasked","")}n.data("caretPositionPreinput",0);n.data("selectionLengthPreinput",0)}function m(t){var n=t.which,r=t.type,i=e.inArray;if(n==16||n==91||n==9)return true;var u=e(this),a=u.val(),c=u.data("valuePreinput")||"",v=p(a),g=u.attr("value-unmasked")||"",y=s(this)||0,b=u.data("caretPositionPreinput")||0,w=y-b,E=l[0],S=l[v.length],x=o(this),T=u.data("selectionLengthPreinput")||0,N=x>0,C=T>0,k=a.length>c.length||T&&a.length>c.length-T,L=a.length<c.length||T&&a.length==c.length-T,A=n>=37&&n<=40&&t.shiftKey,O=n==37,M=n==8||r!="keyup"&&L&&w===-1,_=n==46||r!="keyup"&&L&&w===0&&!C,D=(O||M||r=="click")&&y>0;u.data("selectionLengthPreinput",x);u.unbind("mouseout.mask").one("mouseout.mask",m);if(r=="mouseout"||A||N&&r=="click")return true;if(r=="input"&&L&&!C&&v===g){while(M&&y>0&&i(y,l)==-1)y--;while(_&&y<h.length&&i(y,l)==-1)y++;var P=i(y,l);v=v.substring(0,P)+v.substring(P+1)}u.attr("value-unmasked",v);u.data("isUnmaskedValueValid",v.length===l.length);var H=d(v);u.data("valuePreinput",H);u.val(H);if(y<=E&&k)y=E+1;y=y>S?S:y;if(D)y--;while(i(y,l)===-1){if(D)y--;else y++;if(y<l[0]){y=l[0];D=false;break}else if(y>=f.length){y=l[l.length-1]+1;D=false;break}}if(D||k&&i(b,l)===-1)y++;u.data("caretPositionPreinput",y);s(this,y)}var a=e(u),f=a.attr("mask")||t,l=[],c=[],h="";if(f===r)return true;e.each(f.split(""),function(e,t){if(i[t]){l.push(e);h+="_";c.push(i[t])}else h+=t});if(!l.length)return this;(function(e){var t=e.val(),n=d(t),r=p(n),i=r.length===l.length;e.val(n);e.removeAttr("maxlength");e.attr("value-unmasked",r);e.data("isUnmaskedValueValid",i)})(a);a.attr("placeholder",h);a.unbind(".mask");a.bind("blur.mask",v).triggerHandler("blur");a.bind("input.mask propertychange.mask keyup.mask click.mask",m)})}})})(jQuery,window,document)